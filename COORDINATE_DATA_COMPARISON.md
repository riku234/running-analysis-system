# 座標データ形式の比較

## 提供された座標データ

### 形式
- **関節点数**: 23個
- **座標**: XYZ（3次元）
- **データ構造**: 各行が1フレーム、各フレームに23点 × 3座標 = 69カラム

### 関節点の定義
```python
keypoints_labels = [
    "Right Hand", "Right Wrist", "Right Elbow", "Right Shoulder",
    "Left Hand", "Left Wrist", "Left Elbow", "Left Shoulder",
    "Right Toe", "Right Ball", "Right Heel", "Right Ankle", "Right Knee", "Right Hip",
    "Left Toe", "Left Ball", "Left Heel", "Left Ankle", "Left Knee", "Left Hip",
    "Head Top", "Ear", "Body Center"
]
```

### 座標値の範囲
- 提供されたデータを見ると、座標値は**実世界の座標系**（メートル単位など）のようです
- 例: `x=0.607920, y=1.102957, z=0.888386`

---

## 現在のシステム（MediaPipe Pose）

### 形式
- **ランドマーク数**: 33個
- **座標**: 正規化座標（0.0-1.0）
- **データ構造**: 各キーポイントに `{x, y, z, visibility}`

### ランドマークの定義
```python
LANDMARK_INDICES = {
    "nose": 0, "left_eye": 2, "right_eye": 5,
    "left_shoulder": 11, "right_shoulder": 12,
    "left_hip": 23, "right_hip": 24,
    "left_knee": 25, "right_knee": 26,
    "left_ankle": 27, "right_ankle": 28,
    # ... 合計33個
}
```

### 座標値の範囲
- **正規化座標**: 0.0-1.0の範囲
- 例: `x=0.5, y=0.5, z=0.0`

---

## 違い

### 1. 関節点数
- **提供データ**: 23個
- **MediaPipe**: 33個（顔のランドマークなども含む）

### 2. 座標系
- **提供データ**: 実世界座標（メートル単位など、絶対値）
- **MediaPipe**: 正規化座標（0.0-1.0、相対値）

### 3. データ構造
- **提供データ**: フラットな配列（23点 × 3座標 = 69要素）
- **MediaPipe**: 構造化されたオブジェクト（各点に `{x, y, z, visibility}`）

---

## 変換の可能性

### 提供データをMediaPipe形式に変換する場合

1. **関節点のマッピング**
   - 提供データの23点をMediaPipeの33点にマッピング
   - 対応する点（肩、腰、膝、足首など）は直接マッピング可能
   - MediaPipeにない点（Body Centerなど）は計算で補完

2. **座標の正規化**
   - 実世界座標を正規化座標（0.0-1.0）に変換
   - 動画の解像度やカメラの位置を考慮

3. **不足するランドマークの補完**
   - 顔のランドマーク（鼻、目、耳など）は推定または固定値
   - 手の詳細なランドマークも推定が必要

---

## 現在の実装での対応

現在のシステムでは：
- **標準モデルの角度データ**からキーポイント座標を生成
- MediaPipe形式（33個のランドマーク、正規化座標）で出力
- 提供された座標データとは**異なる形式**ですが、目的（骨格表示）は同じ

### 提供データを使用する場合の利点
- より正確な座標データ
- 実世界の座標系での計算が可能

### 現在の方法の利点
- MediaPipeと互換性がある
- 角度データから生成できるため、標準モデルとの整合性が高い

---

## 結論

提供された座標データと現在のシステムの座標データは**異なる形式**です。

- **提供データ**: 23点、実世界座標、フラット配列
- **現在のシステム**: 33点、正規化座標、構造化オブジェクト

ただし、**目的は同じ**（骨格表示）なので、どちらを使用しても骨格を表示することは可能です。

現在の実装では、標準モデルの角度データからMediaPipe形式のキーポイントを生成しています。提供された座標データを使用する場合は、変換処理が必要になります。
